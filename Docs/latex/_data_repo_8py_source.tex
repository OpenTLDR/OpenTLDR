\doxysection{Data\+Repo.\+py}
\hypertarget{_data_repo_8py_source}{}\label{_data_repo_8py_source}\index{/Users/chrisargenta/dev/opentldr/OpenTLDR-\/Core/src/opentldr/DataRepo.py@{/Users/chrisargenta/dev/opentldr/OpenTLDR-\/Core/src/opentldr/DataRepo.py}}
\mbox{\hyperlink{_data_repo_8py}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00001}\mbox{\hyperlink{namespaceopentldr_1_1_data_repo}{00001}}\ \textcolor{keyword}{import}\ os}
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00002}00002\ \textcolor{keyword}{import}\ re}
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00003}00003\ \textcolor{keyword}{from}\ abc\ \textcolor{keyword}{import}\ ABC,\ abstractmethod\ }
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00004}00004\ \textcolor{keyword}{from}\ datetime\ \textcolor{keyword}{import}\ datetime}
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00005}00005\ }
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00006}00006\ \textcolor{keyword}{from}\ dotenv\ \textcolor{keyword}{import}\ load\_dotenv}
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00007}00007\ load\_dotenv()}
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00008}00008\ }
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00009}00009\ \textcolor{keyword}{from}\ .KnowledgeGraph\ \textcolor{keyword}{import}\ KnowledgeGraph}
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00010}00010\ }
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00011}00011\ \textcolor{keyword}{from}\ .AbstractDataRepo\ \textcolor{keyword}{import}\ AbstractDataRepo}
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00012}00012\ \textcolor{keyword}{from}\ .FileSystemDataRepo\ \textcolor{keyword}{import}\ FileSystemDataRepo}
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00013}00013\ \textcolor{keyword}{from}\ .S3DataRepo\ \textcolor{keyword}{import}\ S3DataRepo}
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00014}00014\ }
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00015}00015\ \textcolor{keyword}{from}\ .log\ \textcolor{keyword}{import}\ log}
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00016}00016\ }
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00017}\mbox{\hyperlink{classopentldr_1_1_data_repo_1_1_data_repo}{00017}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classopentldr_1_1_data_repo_1_1_data_repo}{DataRepo}}(\mbox{\hyperlink{classopentldr_1_1_abstract_data_repo_1_1_abstract_data_repo}{AbstractDataRepo}}):}
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00018}00018\ \ \ \ \ \textcolor{stringliteral}{'''}}
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00019}00019\ \textcolor{stringliteral}{\ \ \ \ Factory\ class\ to\ setup\ any\ type\ of\ DataRepo\ from\ the\ configuration\ inputs.}}
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00020}00020\ \textcolor{stringliteral}{\ \ \ \ '''}}
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00021}00021\ \ \ \ \ repo:AbstractDataRepo}
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00022}00022\ }
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00023}00023\ }
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00024}\mbox{\hyperlink{classopentldr_1_1_data_repo_1_1_data_repo_aedbb6630e1585b727e55335884156fd8}{00024}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classopentldr_1_1_data_repo_1_1_data_repo_aedbb6630e1585b727e55335884156fd8}{\_configOrEnv}}(self,\ key:str,\ config:dict)\ -\/>\ str:}
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00025}00025\ \ \ \ \ \ \ \ \ value:str=config.get(key)}
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00026}00026\ }
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00027}00027\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ setting\ in\ environment\ to\ override\ configurations\ for\ automation}}
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00028}00028\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ os.getenv(\textcolor{stringliteral}{"{}OVERRIDE\_CONTENT\_REPO\_CONFIGS"{}})\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00029}00029\ \ \ \ \ \ \ \ \ \ \ \ \ value=\textcolor{keywordtype}{None}}
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00030}00030\ }
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00031}00031\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ value\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00032}00032\ \ \ \ \ \ \ \ \ \ \ \ \ value\ =\ config.get(key.capitalize())}
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00033}00033\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ value\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00034}00034\ \ \ \ \ \ \ \ \ \ \ \ \ value\ =\ os.getenv(key)}
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00035}00035\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ value\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00036}00036\ \ \ \ \ \ \ \ \ \ \ \ \ value\ =\ os.getenv(key.capitalize())}
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00037}00037\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ value\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00038}00038\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ TypeError(\textcolor{stringliteral}{"{}No\ value\ found\ for\ '\{key\}',\ which\ is\ required."{}}.format(key=key))}
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00039}00039\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ value}
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00040}00040\ }
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00041}00041\ }
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00042}\mbox{\hyperlink{classopentldr_1_1_data_repo_1_1_data_repo_aa8d1e6e3d200f128ced8be621f8e4e43}{00042}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classopentldr_1_1_data_repo_1_1_data_repo_aa8d1e6e3d200f128ced8be621f8e4e43}{\_\_init\_\_}}(self,\ kg:KnowledgeGraph,\ config:dict):}
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00043}00043\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ config\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00044}00044\ \ \ \ \ \ \ \ \ \ \ \ \ log.warn(\textcolor{stringliteral}{"{}No\ config\ file\ passed\ to\ DataRepo,\ defaulting\ to\ using\ environment\ variables."{}})}
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00045}00045\ \ \ \ \ \ \ \ \ \ \ \ \ config=\textcolor{stringliteral}{"{}\{\}"{}}}
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00046}00046\ }
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00047}00047\ \ \ \ \ \ \ \ \ type\ =\ self.\mbox{\hyperlink{classopentldr_1_1_data_repo_1_1_data_repo_aedbb6630e1585b727e55335884156fd8}{\_configOrEnv}}(\textcolor{stringliteral}{"{}repo\_type"{}},config);}
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00048}00048\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ TODO:\ The\ s3/files\ check\ here\ make\ the\ "{}case\ \_"{}\ branch\ unreachable.}}
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00049}00049\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ I\ recommend\ deleting\ the\ check\ here.\ \ Making\ it\ easier\ to\ expand\ cases\ below\ in\ the\ future.}}
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00050}00050\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ type\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}\ \textcolor{keywordflow}{or}\ type\ \textcolor{keywordflow}{not}\ \textcolor{keywordflow}{in}\ [\textcolor{stringliteral}{'s3'},\textcolor{stringliteral}{'files'}]:}
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00051}00051\ \ \ \ \ \ \ \ \ \ \ \ \ message=(\textcolor{stringliteral}{"{}DataRepo\ factory\ requires\ a\ dictionary\ structure\ as\ a\ parameter\ that\ includes\ at\ least\ a\ 'repo\_type'\ entry\ set\ to\ one\ of\ 's3'\ or\ 'files'."{}})}
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00052}00052\ \ \ \ \ \ \ \ \ \ \ \ \ log.error(message)}
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00053}00053\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ TypeError(message)}
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00054}00054\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00055}00055\ \ \ \ \ \ \ \ \ match\ type:}
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00056}00056\ \ \ \ \ \ \ \ \ \ \ \ \ case\ \textcolor{stringliteral}{"{}s3"{}}:}
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00057}00057\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bucket\_name=self.\mbox{\hyperlink{classopentldr_1_1_data_repo_1_1_data_repo_aedbb6630e1585b727e55335884156fd8}{\_configOrEnv}}(\textcolor{stringliteral}{"{}bucket"{}},config)}
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00058}00058\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ aws\_access\_key\_id=self.\mbox{\hyperlink{classopentldr_1_1_data_repo_1_1_data_repo_aedbb6630e1585b727e55335884156fd8}{\_configOrEnv}}(\textcolor{stringliteral}{"{}aws\_access\_key\_id"{}},config)}
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00059}00059\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ aws\_secret\_access\_key=self.\mbox{\hyperlink{classopentldr_1_1_data_repo_1_1_data_repo_aedbb6630e1585b727e55335884156fd8}{\_configOrEnv}}(\textcolor{stringliteral}{"{}aws\_secret\_access\_key"{}},config)}
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00060}00060\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ prefix=self.\mbox{\hyperlink{classopentldr_1_1_data_repo_1_1_data_repo_aedbb6630e1585b727e55335884156fd8}{\_configOrEnv}}(\textcolor{stringliteral}{"{}prefix"{}},config)}
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00061}\mbox{\hyperlink{classopentldr_1_1_data_repo_1_1_data_repo_aa425a030fc1f5c2b11441dea0ab2f59f}{00061}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classopentldr_1_1_data_repo_1_1_data_repo_aa425a030fc1f5c2b11441dea0ab2f59f}{repo}}=\ \mbox{\hyperlink{classopentldr_1_1_s3_data_repo_1_1_s3_data_repo}{S3DataRepo}}(kg,bucket\_name=bucket\_name,\ aws\_access\_key\_id=aws\_access\_key\_id,\ }
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00062}00062\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ aws\_secret\_access\_key=aws\_secret\_access\_key,\ prefix=prefix)}
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00063}00063\ \ \ \ \ \ \ \ \ \ \ \ \ case\ \textcolor{stringliteral}{"{}files"{}}:}
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00064}00064\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ingest\_path=self.\mbox{\hyperlink{classopentldr_1_1_data_repo_1_1_data_repo_aedbb6630e1585b727e55335884156fd8}{\_configOrEnv}}(\textcolor{stringliteral}{"{}path"{}},config)}
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00065}00065\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classopentldr_1_1_data_repo_1_1_data_repo_aa425a030fc1f5c2b11441dea0ab2f59f}{repo}}=\ \mbox{\hyperlink{classopentldr_1_1_file_system_data_repo_1_1_file_system_data_repo}{FileSystemDataRepo}}(kg,ingest\_path=ingest\_path)}
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00066}00066\ \ \ \ \ \ \ \ \ \ \ \ \ case\ \_:}
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00067}00067\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ message:str\ =\ \textcolor{stringliteral}{"{}Invalid\ 'type'\ config\ ('\{type\}')."{}}.format(type=type)}
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00068}00068\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ log.error(message)}
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00069}00069\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ NotImplementedError(message)}
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00070}00070\ }
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00071}\mbox{\hyperlink{classopentldr_1_1_data_repo_1_1_data_repo_a08ce6b1bc233fb7de67a728b5ee1ef48}{00071}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classopentldr_1_1_data_repo_1_1_data_repo_a08ce6b1bc233fb7de67a728b5ee1ef48}{importData}}(self)\ -\/>\ list[str]:}
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00072}00072\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ self.\mbox{\hyperlink{classopentldr_1_1_data_repo_1_1_data_repo_aa425a030fc1f5c2b11441dea0ab2f59f}{repo}}\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00073}00073\ \ \ \ \ \ \ \ \ \ \ \ \ log.error(\textcolor{stringliteral}{"{}No\ DataRepo\ was\ configured."{}})}
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00074}00074\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ self.\mbox{\hyperlink{classopentldr_1_1_data_repo_1_1_data_repo_aa425a030fc1f5c2b11441dea0ab2f59f}{repo}}.\mbox{\hyperlink{classopentldr_1_1_data_repo_1_1_data_repo_a08ce6b1bc233fb7de67a728b5ee1ef48}{importData}}()}
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00075}00075\ }
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00076}\mbox{\hyperlink{classopentldr_1_1_data_repo_1_1_data_repo_a4a430b04fbc88e0135a64a77d2b72307}{00076}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classopentldr_1_1_data_repo_1_1_data_repo_a4a430b04fbc88e0135a64a77d2b72307}{describe}}(self)\ -\/>\ str:}
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00077}00077\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ self.\mbox{\hyperlink{classopentldr_1_1_data_repo_1_1_data_repo_aa425a030fc1f5c2b11441dea0ab2f59f}{repo}}\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00078}00078\ \ \ \ \ \ \ \ \ \ \ \ \ log.error(\textcolor{stringliteral}{"{}No\ DataRepo\ was\ configured."{}})}
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00079}00079\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ self.\mbox{\hyperlink{classopentldr_1_1_data_repo_1_1_data_repo_aa425a030fc1f5c2b11441dea0ab2f59f}{repo}}.\mbox{\hyperlink{classopentldr_1_1_data_repo_1_1_data_repo_a4a430b04fbc88e0135a64a77d2b72307}{describe}}()}
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00080}00080\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{_data_repo_8py_source_l00081}00081\ \ }

\end{DoxyCode}
